
(function(a){a.fn.extend({pschecker:function(b){var c=a.extend({minlength:8,maxlength:16,onPasswordValidate:null,onPasswordMatch:null},b);return this.each(function(){var d=a(".password-container");var k=a(".strong-password:eq(0)",d);var g=a(".strong-password:eq(1)",d);var j=0;g.removeClass("no-match");k.keyup(f).blur(f).focus(f);g.keyup(f).blur(f).focus(f);function f(){var r=k.val().toString();var o=a(".meter");var n=a(".indicador_clave");var t=a("#diffpasswords");o.html("");if(c.onPasswordValidate!=null){c.onPasswordValidate(r.length>=c.minlength)}if(r.length<c.maxlength){o.removeClass("strong").removeClass("medium").removeClass("week");n.html("<div class='progress progress-xs active'><div class='progress-bar progress-bar-striped progress-bar-info' style='width: 0%'></div></div><p class='text-muted'>Nivel de Seguridad</p>");t.html("")}if(r.length>0){var m=new RegExp(/^(?=(.*[a-z]){1,})(?=(.*[\d]){1,})(?=(.*[\W]){1,})(?!.*\s).{7,30}$/);if(m.test(r)){o.addClass("strong");o.html("Strong");n.html("<div class='progress progress-xs active'><div class='progress-bar progress-bar-striped progress-bar-green' style='width: 100%'></div></div><p class='text-green'>Contraseña Fuerte</p>")}else{var p=e(r);var q=l(r);var u=h(r);var s=i(r);var v=p+q+u+s;j=v;if(v>2){o.addClass("medium");o.html("Medium");n.html("<div class='progress progress-xs active'><div class='progress-bar progress-bar-striped progress-bar-warning' style='width: 66%'></div></div><p class='text-yellow'>Contraseña Normal</p>")}else{o.addClass("week");o.html("Week");n.html("<div class='progress progress-xs active'><div class='progress-bar progress-bar-striped progress-bar-red' style='width: 33%'></div></div><p class='text-red'>Contraseña Debil</p>")}}if(g.val().toString().length>0){if(r==g.val().toString()){g.removeClass("no-match");if(c.onPasswordMatch!=null&&j>2){a("#level").val("1");c.onPasswordMatch(true);t.html("")}else{t.html("La contraseña no cumple el nivel mínimo de seguridad")}}else{a("#level").val("0");g.addClass("no-match");t.html("Las contraseñas no coinciden");if(c.onPasswordMatch!=null){c.onPasswordMatch(false)}}}else{a("#level").val("0");t.html("Las contraseñas no coinciden");g.addClass("no-match");if(c.onPasswordMatch!=null){c.onPasswordMatch(false)}}}}function e(n){var m=new RegExp(/[a-z]/);if(m.test(n)){return 1}return 0}function l(n){var m=new RegExp(/[0-9]/);if(m.test(n)){return 1}return 0}function h(n){var m=new RegExp(/[A-Z]/);if(m.test(n)){return 1}return 0}function i(n){var m=new RegExp(/[\W]/);if(m.test(n)){return 1}return 0}})}})})(jQuery);